base: https://github.com/kubernetes/kubernetes

releases:
  - name: v1.18.20-lts.1
    base_release: v1.18.20-ci
    must: true
    patches:
      - CVE-2021-25741.1.18
      - nokmem.1.18
  - name: v1.18.20-ci
    base_release: v1.18.20
    patches:
      - fix-run-docker.1.18
      - no-delete-images.1.18
      - fix-etcd-put-key.1.18
    test_failures_tolerated:
      - k8s.io/kubernetes/pkg/kubelet/volumemanager/reconciler
      - k8s.io/kubernetes/pkg/volume/csi
      - k8s.io/kubernetes/vendor/k8s.io/apiserver/pkg/server
    test_integration_failures_tolerated: []


patches:
  - name: fix-run-docker.1.18
    patch:
      - patches/fix-run-docker.1.18.patch

  - name: no-delete-images.1.18
    patch:
      - patches/no-delete-images.1.18.patch



  - name: CVE-2021-25741.1.18
    patch:
      - patches/CVE-2021-25741.1.18.patch # Conflict resolution

  - name: nokmem.1.18 # < k8s1.22
    patch:
      # Hard-coded disabling kmem to prevent seemingly disabling actually enabling
      # TODO: upgrade runc instead of this
      - patches/nokmem.1.18.patch

  - name: fix-etcd-put-key.1.18
    patch:
      - patches/fix-etcd-put-key.1.18.patch

  - name: fix-missing-env-91500.1.18
    patch:
      - patches/fix-missing-env-91500.1.18.patch

  - name: add-log.1.18
    patch:
      - patches/add-log.1.18.patch
